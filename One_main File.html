<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Distributor Inventory System</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #4361ee;
      --secondary-color: #3f37c9;
      --accent-color: #4895ef;
      --light-color: #f8f9fa;
      --dark-color: #212529;
      --success-color: #4cc9f0;
      --warning-color: #f72585;
      --border-radius: 8px;
      --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f7fa;
      color: var(--dark-color);
    }

    .dashboard {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 250px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 20px 0;
      box-shadow: var(--box-shadow);
    }

    .sidebar h2 {
      padding: 0 20px 20px;
      font-size: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar ul {
      list-style: none;
      margin-top: 20px;
    }

    .sidebar li {
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sidebar li:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .sidebar li.active {
      background-color: rgba(255, 255, 255, 0.2);
      border-left: 4px solid white;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background-color: white;
      box-shadow: var(--box-shadow);
      z-index: 1;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 500;
    }

    .user-profile i {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    .form-container {
      padding: 20px;
      flex: 1;
      overflow-y: auto;
    }

    .form-section {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 20px;
      margin-bottom: 20px;
    }

    .form-section h2 {
      color: var(--primary-color);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #555;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: border 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(72, 149, 239, 0.2);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .search-box {
      position: relative;
      width: 250px;
    }

    .search-box input {
      width: 100%;
      padding: 10px 10px 10px 35px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
    }

    .search-box i {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #777;
    }

    .table-container {
      overflow-x: auto;
      border-radius: var(--border-radius);
      border: 1px solid #eee;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    th {
      background-color: #f8f9fa;
      font-weight: 600;
      color: #555;
    }

    td {
      vertical-align: middle;
    }

    input[type="number"] {
      width: 80px;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      text-align: center;
    }

    input[type="number"]:focus {
      outline: none;
      border-color: var(--accent-color);
    }

    input[readonly] {
      background-color: #f8f9fa;
      border-color: #eee;
    }

    .table-footer {
      padding: 10px 15px;
      background-color: #f8f9fa;
      color: #777;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .submit-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 20px auto;
      transition: all 0.3s;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(67, 97, 238, 0.2);
    }

    /* Records Section */
    .records-container {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 20px;
      margin-bottom: 20px;
      display: none;
    }

    .records-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .records-filters {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-group label {
      font-weight: 500;
      color: #555;
    }

    .filter-group input,
    .filter-group select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
    }

    .filter-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: background-color 0.3s;
    }

    .filter-btn:hover {
      background-color: var(--secondary-color);
    }

    .records-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .summary-card {
      background-color: #f8f9fa;
      border-radius: var(--border-radius);
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .summary-card i {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    .summary-card h3 {
      font-size: 0.9rem;
      color: #777;
      margin-bottom: 5px;
    }

    .summary-card span {
      font-size: 1.3rem;
      font-weight: 600;
    }

    .records-table-container {
      overflow-x: auto;
    }

    #recordsTable {
      width: 100%;
    }

    .records-pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-top: 20px;
    }

    .records-pagination button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .records-pagination button:hover {
      background-color: var(--secondary-color);
    }

    .records-pagination button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    /* Pagination Controls */
    .pagination-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .pagination-controls button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .pagination-controls button:hover {
      background-color: var(--secondary-color);
    }

    .pagination-controls button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    /* Highlight searched text */
    .highlight {
      background-color: yellow;
      font-weight: bold;
    }

    /* Notification styles */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: var(--border-radius);
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: var(--box-shadow);
      z-index: 1000;
      animation: slideIn 0.3s ease-out;
      transition: all 0.3s;
    }
    
    .notification.success {
      background-color: #d4edda;
      color: #155724;
      border-left: 4px solid #28a745;
    }
    
    .notification.error {
      background-color: #f8d7da;
      color: #721c24;
      border-left: 4px solid #dc3545;
    }
    
    .notification i {
      font-size: 1.2rem;
    }
    
    .fade-out {
      transform: translateX(100%);
      opacity: 0;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .dashboard {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        height: auto;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .search-box {
        width: 100%;
      }
      
      .records-filters {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .filter-group {
        width: 100%;
      }
      
      .filter-group input,
      .filter-group select {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <div class="sidebar">
      <h2>Inventory System</h2>
      <ul>
        <li class="active"><i class="fas fa-clipboard-list"></i> New Entry</li>
        <li><i class="fas fa-history"></i> View Records</li>
        <li><i class="fas fa-cog"></i> Settings</li>
      </ul>
    </div>
    
    <div class="main-content">
      <div class="header">
        <h1>Distributor Inventory Entry</h1>
        <div class="user-profile">
          <span>Admin</span>
          <i class="fas fa-user-circle"></i>
        </div>
      </div>
      
      <div class="form-container" id="entryForm">
        <form id="inventoryForm">
          <div class="form-section">
            <h2><i class="fas fa-user-tie"></i> Distributor Details</h2>
            <div class="form-grid">
              <div class="form-group">
                <label for="distributor_name">Distributor Name*</label>
                <input type="text" id="distributor_name" name="distributor_name" required>
              </div>
              
              <div class="form-group">
                <label for="town">Town*</label>
                <input type="text" id="town" name="town" required>
              </div>
              
              <div class="form-group">
                <label for="super_stockist">Super Stockist</label>
                <input type="text" id="super_stockist" name="super_stockist">
              </div>
              
              <div class="form-group">
                <label for="state">State*</label>
                <input type="text" id="state" name="state" required>
              </div>
              
              <div class="form-group">
                <label for="entered_by">Entered By</label>
                <input type="text" id="entered_by" name="entered_by">
              </div>
              
              <div class="form-group">
                <label for="mobile">Mobile No.*</label>
                <input type="tel" id="mobile" name="mobile" required>
              </div>
            </div>
          </div>
          
          <div class="form-section">
            <div class="section-header">
              <h2><i class="fas fa-boxes"></i> Inventory Details</h2>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search items..." id="productSearch">
              </div>
            </div>
            
            <div class="table-container">
              <table id="inventoryTable">
                <thead>
                  <tr>
                    <th>Item Name</th>
                    <th>Opening</th>
                    <th>Purchase</th>
                    <th>Sale</th>
                    <th>Closing</th>
                  </tr>
                </thead>
                <tbody id="inventoryItems">
                  <!-- Products will be loaded here by JavaScript -->
                </tbody>
              </table>
              
              <div class="table-footer">
                <div class="pagination-controls">
                  <button id="prevPage"><i class="fas fa-chevron-left"></i></button>
                  <span id="pageInfo">Page 1 of 6</span>
                  <button id="nextPage"><i class="fas fa-chevron-right"></i></button>
                </div>
                <span id="itemCount">Showing 1-10 of 60 items</span>
              </div>
            </div>
          </div>
          
          <button type="submit" class="submit-btn">
            <i class="fas fa-paper-plane"></i> Submit Data
          </button>
        </form>
      </div>
      
      <!-- View Records Section -->
      <div class="records-container" id="viewRecords">
        <div class="records-header">
          <h2><i class="fas fa-history"></i> Inventory Records</h2>
          <div class="records-filters">
            <div class="filter-group">
              <label for="dateFrom">From:</label>
              <input type="date" id="dateFrom">
            </div>
            <div class="filter-group">
              <label for="dateTo">To:</label>
              <input type="date" id="dateTo">
            </div>
            <div class="filter-group">
              <label for="distributorFilter">Distributor:</label>
              <select id="distributorFilter">
                <option value="">All Distributors</option>
                <!-- Will be populated by JavaScript -->
              </select>
            </div>
            <button id="applyFilters" class="filter-btn">
              <i class="fas fa-filter"></i> Apply
            </button>
          </div>
        </div>
        
        <div class="records-summary">
          <div class="summary-card">
            <i class="fas fa-box-open"></i>
            <div>
              <h3>Total Items</h3>
              <span id="totalItems">0</span>
            </div>
          </div>
          <div class="summary-card">
            <i class="fas fa-arrow-up"></i>
            <div>
              <h3>Total Purchases</h3>
              <span id="totalPurchases">0</span>
            </div>
          </div>
          <div class="summary-card">
            <i class="fas fa-arrow-down"></i>
            <div>
              <h3>Total Sales</h3>
              <span id="totalSales">0</span>
            </div>
          </div>
        </div>
        
        <div class="records-table-container">
          <table id="recordsTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Distributor</th>
                <th>Town</th>
                <th>Item</th>
                <th>Opening</th>
                <th>Purchase</th>
                <th>Sale</th>
                <th>Closing</th>
              </tr>
            </thead>
            <tbody id="recordsData">
              <!-- Records will be loaded here by JavaScript -->
            </tbody>
          </table>
          
          <div class="records-pagination">
            <button id="prevRecords"><i class="fas fa-chevron-left"></i></button>
            <span id="recordsPageInfo">Page 1</span>
            <button id="nextRecords"><i class="fas fa-chevron-right"></i></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => 
    {
      // Sample product data (60 products)
      const products = [
        "Biscuits", "Confectionery", "Juice", "Cookies", "Noodles",
        "Chocolates", "Chips", "Soft Drinks", "Tea", "Coffee",
        "Milk Powder", "Cereal", "Pasta", "Sauce", "Jam",
        "Honey", "Pickles", "Rice", "Flour", "Sugar",
        "Salt", "Spices", "Oil", "Vinegar", "Mayonnaise",
        "Ketchup", "Mustard", "Peanut Butter", "Bread", "Butter",
        "Cheese", "Yogurt", "Ice Cream", "Frozen Vegetables", "Frozen Snacks",
        "Canned Vegetables", "Canned Fruits", "Canned Fish", "Canned Meat", "Bottled Water",
        "Energy Drinks", "Sports Drinks", "Baby Food", "Pet Food", "Cleaning Supplies",
        "Paper Products", "Plastic Ware", "Batteries", "Light Bulbs", "Personal Care",
        "Shampoo", "Soap", "Toothpaste", "Deodorant", "Razors",
        "Vitamins", "Medicines", "First Aid", "Stationery", "Toys"
      ];

      // Pagination variables
      let currentPage = 1;
      const itemsPerPage = 10;
      let filteredProducts = [...products];

      // Records variables
      let recordsCurrentPage = 1;
      const recordsPerPage = 10;
      let allRecords = []; // Will be populated from server

      // DOM elements
      const inventoryItems = document.getElementById('inventoryItems');
      const prevPageBtn = document.getElementById('prevPage');
      const nextPageBtn = document.getElementById('nextPage');
      const pageInfo = document.getElementById('pageInfo');
      const itemCount = document.getElementById('itemCount');
      const searchInput = document.getElementById('productSearch');
      const entryForm = document.getElementById('entryForm');
      const viewRecords = document.getElementById('viewRecords');
      const navLinks = document.querySelectorAll('.sidebar li');
      const recordsTable = document.getElementById('recordsData');
      const dateFrom = document.getElementById('dateFrom');
      const dateTo = document.getElementById('dateTo');
      const distributorFilter = document.getElementById('distributorFilter');
      const applyFilters = document.getElementById('applyFilters');
      const prevRecords = document.getElementById('prevRecords');
      const nextRecords = document.getElementById('nextRecords');
      const recordsPageInfo = document.getElementById('recordsPageInfo');
      const totalItems = document.getElementById('totalItems');
      const totalPurchases = document.getElementById('totalPurchases');
      const totalSales = document.getElementById('totalSales');

      // Initialize the application
      function init() {
        loadProducts();
        setupEventListeners();
        setupNavigation();
        loadSampleRecords(); // Replace with actual API call
        
        // Set default dates for filters
        const today = new Date();
        const oneMonthAgo = new Date();
        oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
        
        dateFrom.valueAsDate = oneMonthAgo;
        dateTo.valueAsDate = today;
      }

      // Load products with pagination
      function loadProducts() {
        inventoryItems.innerHTML = '';
        
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedProducts = filteredProducts.slice(startIndex, endIndex);
        
        paginatedProducts.forEach(product => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${highlightSearchTerm(product)}</td>
            <td><input type="number" name="opening_stock[]" min="0" data-product="${product}"></td>
            <td><input type="number" name="purchase[]" min="0" data-product="${product}"></td>
            <td><input type="number" name="sale[]" min="0" data-product="${product}"></td>
            <td><input type="number" name="closing_stock[]" min="0" readonly data-product="${product}"></td>
          `;
          inventoryItems.appendChild(row);
          
          // Set up event listeners for calculations
          const inputs = row.querySelectorAll('input[type="number"]:not([readonly])');
          inputs.forEach(input => {
            input.addEventListener('input', calculateClosingStock);
          });
        });
        
        updatePaginationInfo();
      }

      // Calculate closing stock
      function calculateClosingStock() {
        const row = this.closest('tr');
        const opening = parseInt(row.querySelector('input[name="opening_stock[]"]').value) || 0;
        const purchase = parseInt(row.querySelector('input[name="purchase[]"]').value) || 0;
        const sale = parseInt(row.querySelector('input[name="sale[]"]').value) || 0;
        const closing = opening + purchase - sale;
        row.querySelector('input[name="closing_stock[]"]').value = closing >= 0 ? closing : 0;
      }

      // Update pagination information
      function updatePaginationInfo() {
        const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
        pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
        
        const startItem = ((currentPage - 1) * itemsPerPage) + 1;
        const endItem = Math.min(currentPage * itemsPerPage, filteredProducts.length);
        itemCount.textContent = `Showing ${startItem}-${endItem} of ${filteredProducts.length} items`;
        
        prevPageBtn.disabled = currentPage === 1;
        nextPageBtn.disabled = currentPage === totalPages;
      }

      // Highlight search term in product names
      function highlightSearchTerm(productName) {
        if (!searchInput.value) return productName;
        
        const regex = new RegExp(searchInput.value, 'gi');
        return productName.replace(regex, match => 
          `<span class="highlight">${match}</span>`
        );
      }

      // Load sample records (replace with actual API call)
      function loadSampleRecords() {
        // This would be replaced with: fetch('/api/records').then(...)
        allRecords = generateSampleRecords(100);
        updateRecordsDisplay();
        populateDistributorFilter();
        updateSummaryStats();
      }

      // Generate sample records for demo
      function generateSampleRecords(count) {
        const distributors = ['ABC Distributors', 'XYZ Suppliers', 'Best Goods', 'Quick Delivery', 'Prime Wholesale'];
        const towns = ['Mumbai', 'Delhi', 'Bangalore', 'Hyderabad', 'Chennai', 'Kolkata'];
        const dates = [];
        
        // Generate dates for last 30 days
        for (let i = 0; i < 30; i++) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          dates.push(date.toISOString().split('T')[0]);
        }
        
        const records = [];
        for (let i = 0; i < count; i++) {
          records.push({
            date: dates[Math.floor(Math.random() * dates.length)],
            distributor: distributors[Math.floor(Math.random() * distributors.length)],
            town: towns[Math.floor(Math.random() * towns.length)],
            item: products[Math.floor(Math.random() * products.length)],
            opening: Math.floor(Math.random() * 100),
            purchase: Math.floor(Math.random() * 50),
            sale: Math.floor(Math.random() * 70),
            closing: 0 // Will be calculated
          });
        }
        
        // Calculate closing stock
        records.forEach(record => {
          record.closing = record.opening + record.purchase - record.sale;
        });
        
        return records;
      }

      // Update records display with pagination
      function updateRecordsDisplay() {
        const filtered = filterRecords();
        const startIndex = (recordsCurrentPage - 1) * recordsPerPage;
        const paginatedRecords = filtered.slice(startIndex, startIndex + recordsPerPage);
        
        recordsTable.innerHTML = '';
        paginatedRecords.forEach(record => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${record.date}</td>
            <td>${record.distributor}</td>
            <td>${record.town}</td>
            <td>${record.item}</td>
            <td>${record.opening}</td>
            <td>${record.purchase}</td>
            <td>${record.sale}</td>
            <td>${record.closing}</td>
          `;
          recordsTable.appendChild(row);
        });
        
        updateRecordsPaginationInfo(filtered.length);
        updateSummaryStats(filtered);
      }

      // Filter records based on selected filters
      function filterRecords() {
        let filtered = [...allRecords];
        
        // Date filter
        if (dateFrom.value) {
          filtered = filtered.filter(record => record.date >= dateFrom.value);
        }
        if (dateTo.value) {
          filtered = filtered.filter(record => record.date <= dateTo.value);
        }
        
        // Distributor filter
        if (distributorFilter.value) {
          filtered = filtered.filter(record => record.distributor === distributorFilter.value);
        }
        
        return filtered;
      }

      // Update records pagination info
      function updateRecordsPaginationInfo(totalRecords) {
        const totalPages = Math.ceil(totalRecords / recordsPerPage);
        recordsPageInfo.textContent = `Page ${recordsCurrentPage} of ${totalPages}`;
        
        prevRecords.disabled = recordsCurrentPage === 1;
        nextRecords.disabled = recordsCurrentPage === totalPages || totalPages === 0;
      }

      // Update summary statistics
      function updateSummaryStats(records = allRecords) {
        const totalItems = records.reduce((sum, record) => sum + record.opening + record.purchase, 0);
        const totalPurchase = records.reduce((sum, record) => sum + record.purchase, 0);
        const totalSale = records.reduce((sum, record) => sum + record.sale, 0);
        
        document.getElementById('totalItems').textContent = totalItems.toLocaleString();
        document.getElementById('totalPurchases').textContent = totalPurchase.toLocaleString();
        document.getElementById('totalSales').textContent = totalSale.toLocaleString();
      }

      // Populate distributor filter dropdown
      function populateDistributorFilter() {
        const distributors = [...new Set(allRecords.map(record => record.distributor))];
        distributorFilter.innerHTML = '<option value="">All Distributors</option>';
        
        distributors.forEach(distributor => {
          const option = document.createElement('option');
          option.value = distributor;
          option.textContent = distributor;
          distributorFilter.appendChild(option);
        });
      }

      // Set up event listeners
      function setupEventListeners() {
        // Product pagination
        prevPageBtn.addEventListener('click', () => {
          if (currentPage > 1) {
            currentPage--;
            loadProducts();
          }
        });
        
        nextPageBtn.addEventListener('click', () => {
          if (currentPage < Math.ceil(filteredProducts.length / itemsPerPage)) {
            currentPage++;
            loadProducts();
          }
        });
        
        // Search functionality
        searchInput.addEventListener('input', () => {
          const searchTerm = searchInput.value.toLowerCase();
          filteredProducts = products.filter(product => 
            product.toLowerCase().includes(searchTerm)
          );
          currentPage = 1;
          loadProducts();
        });
        
        // Records pagination
        prevRecords.addEventListener('click', () => {
          if (recordsCurrentPage > 1) {
            recordsCurrentPage--;
            updateRecordsDisplay();
          }
        });
        
        nextRecords.addEventListener('click', () => {
          const filtered = filterRecords();
          const totalPages = Math.ceil(filtered.length / recordsPerPage);
          
          if (recordsCurrentPage < totalPages) {
            recordsCurrentPage++;
            updateRecordsDisplay();
          }
        });
        
        // Apply filters
        applyFilters.addEventListener('click', () => {
          recordsCurrentPage = 1;
          updateRecordsDisplay();
        });
        
        // Form submission
        document.getElementById("inventoryForm").addEventListener("submit", handleFormSubmit);
      }

      // Set up navigation between sections
      function setupNavigation() {
        navLinks.forEach(link => {
          link.addEventListener('click', () => {
            navLinks.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            
            if (link.textContent.includes('New Entry')) {
              entryForm.style.display = 'block';
              viewRecords.style.display = 'none';
            } else if (link.textContent.includes('View Records')) {
              entryForm.style.display = 'none';
              viewRecords.style.display = 'block';
            }
          });
        });
      }

      // Form submission handler
      async function handleFormSubmit(e) {
        e.preventDefault();

        const form = e.target;
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

        // Collect distributor info
        const distributorData = {
          distributor_name: form.distributor_name.value,
          town: form.town.value,
          super_stockist: form.super_stockist.value,
          state: form.state.value,
          entered_by: form.entered_by.value,
          mobile: form.mobile.value,
          items: []
        };

        // Collect inventory items
        const rows = form.querySelectorAll('#inventoryTable tbody tr');
        rows.forEach(row => {
          const itemName = row.querySelector('td:first-child').textContent.trim();
          const openingStock = parseInt(row.querySelector('input[name="opening_stock[]"]').value) || 0;
          const purchase = parseInt(row.querySelector('input[name="purchase[]"]').value) || 0;
          const sale = parseInt(row.querySelector('input[name="sale[]"]').value) || 0;
          const closingStock = parseInt(row.querySelector('input[name="closing_stock[]"]').value) || 0;
          
          if (openingStock > 0 || purchase > 0 || sale > 0) {
            distributorData.items.push({
              item_name: itemName,
              opening_stock: openingStock,
              purchase: purchase,
              sale: sale,
              closing_stock: closingStock
            });
          }
        });

        // Validate at least one item has data
        if (distributorData.items.length === 0) {
          showNotification('Please enter data for at least one item', 'error');
          submitBtn.disabled = false;
          submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Data';
          return;
        }

        // Send data to server
        try {
          // In a real app, you would use:
          // const response = await fetch("/submit", {
          //   method: "POST",
          //   headers: { "Content-Type": "application/json" },
          //   body: JSON.stringify(distributorData)
          // });
          
          // For demo purposes, we'll simulate a successful submission
          console.log('Submitting data:', distributorData);
          await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate network delay
          
          showNotification('Data saved successfully!', 'success');
          form.reset();
          
          // Reset closing stock calculations
          const closingInputs = form.querySelectorAll('input[name="closing_stock[]"]');
          closingInputs.forEach(input => input.value = '');
          
          // In a real app, you would refresh the records view:
          // loadSampleRecords();
        } catch (err) {
          console.error("Error submitting form:", err);
          showNotification('Failed to submit form. Please try again.', 'error');
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Data';
        }
      }

      // Show notification
      function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
          <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
          <span>${message}</span>
        `;
        document.body.appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
          notification.classList.add('fade-out');
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }

      // Initialize the application
      init();
    });
  </script>
</body>
</html>